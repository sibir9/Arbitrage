<!DOCTYPE html>  
<html lang="ru">  
<head>  
  <meta charset="UTF-8" />  
  <title>Цена COCA на MEXC и QuickSwap</title>  
  <style>  
    body {  
      font-family: Arial, sans-serif;  
      margin: 40px;  
      text-align: center;  
      background-color: #f0f4f8;  
    }  
    h1 {  
      color: #264653;  
    }  
    .price-block {  
      background-color: #fff;  
      padding: 20px;  
      margin: 20px auto;  
      width: 300px;  
      border-radius: 8px;  
      box-shadow: 0 2px 8px rgba(38, 70, 83, 0.2);  
    }  
    .price-label {  
      font-size: 1.2em;  
      margin-bottom: 8px;  
      color: #2a9d8f;  
    }  
    .price-value {  
      font-size: 2em;  
      font-weight: bold;  
      color: #e76f51;  
    }  
    .error {  
      color: #e63946;  
      font-weight: normal;  
    }  
  </style>  
</head>  
<body>  
  <h1>Актуальная цена токена COCA</h1>  
  
  <div class="price-block">  
    <div class="price-label">MEXC (COCA/USDT):</div>  
    <div id="price-mexc" class="price-value">Загрузка...</div>  
  </div>  
  
  <div class="price-block">  
    <div class="price-label">QuickSwap (COCA/USDT):</div>  
    <div id="price-uniswap" class="price-value">Загрузка...</div>  
  </div>  
  
  <script>  
    // Функция обновления цены с сервера  
    async function updatePrices() {  
      try {  
        // Выполняем запрос на эндпоинт /price, ожидаем JSON-объект с двумя ценами  
        const response = await fetch('/price');  
  
        // Проверяем успешность ответа  
        if (!response.ok) {  
          throw new Error(`HTTP ошибка! Статус: ${response.status}`);  
        }  
  
        // Парсим JSON из ответа сервера  
        const data = await response.json();  
  
        // Обновляем цену MEXC, если она есть и корректна  
        if (data.mexc !== undefined && data.mexc !== null && data.mexc !== 'Ошибка получения') {  
          // Приводим к числу и выводим с 6 знаками после запятой  
          document.getElementById('price-mexc').innerText = Number(data.mexc).toFixed(6);  
          document.getElementById('price-mexc').classList.remove('error');  
        } else {  
          // Отображаем сообщение об ошибке  
          document.getElementById('price-mexc').innerText = 'Ошибка загрузки';  
          document.getElementById('price-mexc').classList.add('error');  
        }  
  
        // Обновляем цену QuickSwap/Uniswap аналогично  
        if (data.uniswap !== undefined && data.uniswap !== null && data.uniswap !== 'Ошибка получения') {  
          document.getElementById('price-uniswap').innerText = Number(data.uniswap).toFixed(6);  
          document.getElementById('price-uniswap').classList.remove('error');  
        } else {  
          document.getElementById('price-uniswap').innerText = 'Ошибка загрузки';  
          document.getElementById('price-uniswap').classList.add('error');  
        }  
      } catch (error) {  
        // В случае ошибки сети или парсинга выводим сообщение и логируем ошибку  
        document.getElementById('price-mexc').innerText = 'Сетевая ошибка';  
        document.getElementById('price-mexc').classList.add('error');  
        document.getElementById('price-uniswap').innerText = 'Сетевая ошибка';  
        document.getElementById('price-uniswap').classList.add('error');  
        console.error('Ошибка при получении цен:', error);  
      }  
    }  
  
    // Запускаем обновление сразу при загрузке страницы  
    updatePrices();  
  
    // Обновляем цены каждые 5 секунд  
    setInterval(updatePrices, 5000);  
  </script>  
</body>  
</html>
